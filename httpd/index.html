<!DOCTYPE html>
<html>
<head>
<title>Kismet Mobile Dashboard</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="js/jquery-3.5.1.min.js"></script>
<script src="js/js.storage.min.js"></script>
<script src="js/onsenui.min.js"></script>
<script src="js/Chart.min.js"></script>
<script src="js/kmd.js"></script>
<script src="js/kmd-login.js"></script>
<script src="js/kmd-home.js"></script>
<script src="js/kmd-channelgraph.js"></script>
<script src="js/kmd-datasource.js"></script>

<link rel="stylesheet" href="css/onsenui.min.css">
<link rel="stylesheet" href="css/onsen-css-components.min.css">
<link rel="stylesheet" href="css/Chart.min.css">
<link rel="stylesheet" href="css/kmd.css" />

<script>
// relative uri of kismet
var kmd_rest_prefix = "../../"

// jQuery onLoad
$(function() {
    kmd.ui.menu = document.getElementById('menu');
    kmd.ui.navi = document.getElementById('navi');
    kmd.ui.navi.addEventListener('postpush', kmd.pageChanged)
    kmd.ui.navi.addEventListener('postpop', kmd.pageChanged)

    kmd_login.checkSession();
});

</script>
</head>

<body>

<ons-splitter>
    <ons-splitter-side id="menu" side="right" width="220px" collapse swipeable>
        <ons-page>
            <ons-list>
                <ons-list-item onclick="kmd.ui.go_home()" tappable>
                    <ons-icon icon="fa-home" class="icon-nav-menu"></ons-icon>
                    Home
                </ons-list-item>
                <ons-list-item onclick="kmd.ui.push_page('datasources.html')" tappable>
                    <ons-icon icon="fa-puzzle-piece" class="icon-nav-menu"></ons-icon>Datasources
                </ons-list-item>
                <ons-list-item onclick="kmd.ui.push_page('interfaces.html')" tappable>
                    <ons-icon icon="fa-code-branch" class="icon-nav-menu"></ons-icon>Interfaces
                </ons-list-item>
                <ons-list-item onclick="kmd_login.showLogin();" tappable>
                    <ons-icon icon="fa-key" class="icon-nav-menu"></ons-icon>Login
                </ons-list-item>
            </ons-list>
        </ons-page>
    </ons-splitter-side>
    <ons-splitter-content>
            <ons-navigator id="navi" page="home-page"></ons-navigator>
    </ons-splitter-content>
</ons-splitter>

<template id="login-page">
    <ons-dialog id="login-dialog">
        <div id="login-content" class="login-text"></div>
    </ons-dialog>
</template>
<template id="token-page">
    <ons-dialog id="token-dialog">
        <div id="token-content" class="login-text"></div>
    </ons-dialog>
</template>

<template id="home-page">
    <ons-page id="home">
        <ons-toolbar>
            <div class="center">
                <ons-icon icon="fa-home" class="icon-header-bar"></ons-icon>Home
            </div>
            <div class="right">
                <ons-toolbar-button onclick="kmd.ui.menu.open()">
                    <ons-icon icon="md-menu"></ons-icon>
                </ons-toolbar-button>
            </div>
        </ons-toolbar>

        <div class="center">
            <div class="card">
                <ons-row class="card-header">
                    <ons-col>System Details: <span id="uptime"></span></ons-col>
                </ons-row>
                <ons-row height="140px">
                    <ons-col></ons-col>
                </ons-row>
                <ons-row>
                    <ons-col class="bignum"><span id="numsources">-</span>/<span id="numsources_total">-</span><br><span class="subtitle" id="SourceErrors">Active/Total Sources</span><br></ons-col>
                    <ons-col class="bignum"><span id="numchans">-</span><br><span class="subtitle">Channels</span></ons-col>
                    <ons-col class="bignum"><span id="numpackets">-</span>
                        <br><span class="subtitle">Packets/sec</span>
                    </ons-col>
                    <ons-col class="bignum"><span id="numdevs">-</span><i class="dataup" id="devup"></i><i class="datadown" id="devdown"></i><br><span class="subtitle">Total # of Devices</span></ons-col>
                </ons-row>
            </div>
            <div class="card">
                <ons-row>
                    <ons-col class="card-header">
                        <ons-icon icon="fa-wifi" class="card-icon"></ons-icon> 802.11 details
                    </ons-col>
                </ons-row>
                <ons-row>
                    <ons-col class="bignum"><span id="num802Aps" onclick="getDev_byType('Wi-Fi AP')" class="show-clickable">-</span><br><span class="subtitle">APs</span></ons-col>
                    <ons-col class="bignum"><span id="num802Clients" onclick="getDev_byType('Wi-Fi Client')" class="show-clickable">-</span><br><span class="subtitle">Clients</span></ons-col>
                    <ons-col class="bignum"><span id="num802Devices" onclick="getDev_byType('Wi-Fi Device')" class="show-clickable">-</span><br><span class="subtitle">Devices</span></ons-col>
                    <ons-col class="bignum"><span id="num802Bridges" onclick="getDev_byType('Wi-Fi Bridged')" class="show-clickable">-</span><br><span class="subtitle">Bridged</span></ons-col>
                    <ons-col class="bignum"><span id="num802Adhoc" onclick="getDev_byType('Wi-Fi Ad-Hoc')" class="show-clickable">-</span><br><span class="subtitle">AdHoc </span></ons-col>
                    <ons-col class="bignum"><span id="num802WDS" onclick="getDev_byType('WiFi WDS')" class="show-clickable">-</span><br><span class="subtitle">WDS </span></ons-col>
                </ons-row>
            </div>
            <div class="card">
                <ons-row>
                    <ons-col class="card-header">
                        <ons-icon icon="fa-wifi" class="card-icon"></ons-icon> 802.11 Channels
                    </ons-col>
                </ons-row>
                <ons-row>
                    <ons-col>
                        <div id="channels" style="width: 100%; height: 150px;">
                            <!-- channels div height set based on previous use of object
                                with html file which seemed to default to 150px (no clear
                                documentation). this is arbitrary and needs a better solution -->
                            <canvas id="channel_chart" width="100%" height="100%"></canvas>
                        </div>
                    </ons-col>
                </ons-row>
            </div>
            <div class="card">
                <ons-row>
                    <ons-col class="card-header">
                        <ons-icon icon="fa-bluetooth-b" class="card-icon"></ons-icon> Bluetooth
                    </ons-col>
                </ons-row>
                <ons-row>
                    <ons-col class="bignum"><span id="numBTLE" onclick="getDev_byType('BTLE')" class="show-clickable">-</span><br><span class="subtitle">BTLE Devices</span></ons-col>
                    <ons-col class="bignum"><span id="numBR" onclick="getDev_byType('BREDR')" class="show-clickable">-</span><br><span class="subtitle">BR/EDR Devices</span></ons-col>
                </ons-row>
            </div>
            <div class="card">
                <ons-row>
                    <ons-col class="card-header">
                        <ons-icon icon="fa-globe" class="card-icon"></ons-icon> Other
                    </ons-col>
                </ons-row>
                <ons-row>
                    <ons-col class="bignum"><span id="numRTL433">-</span><br><span class="subtitle" onclick="getDev_byType('Sensor')" class="show-clickable">RTL433</span></ons-col>
                    <ons-col class="bignum"><span id="numRTLADSB">-</span><br><span class="subtitle" onclick="getDev_byType('Airplane')" class="show-clickable">ADSB</span></ons-col>
                    <ons-col class="bignum"><span id="numRTLAMR">-</span><br><span class="subtitle" onclick="getDev_byType('AMR')" class="show-clickable">AMR</span></ons-col>
                    <ons-col class="bignum"><span id="numZWave">-</span><br><span class="subtitle" onclick="getDev_byType('ZWave')" class="show-clickable">Z-Wave</span></ons-col>
                    <ons-col class="bignum"><span id="numMousejack">-</span><br><span class="subtitle" onclick="getDev_byType('KB/Mouse')" class="show-clickable">Mousejack</span></ons-col>
                    <ons-col class="bignum"><span id="numUAV">-</span><br><span class="subtitle" onclick="getDev_byType('UAV')" class="show-clickable">UAV</span></ons-col>
                </ons-row>
            </div>
        </div>
        <ons-bottom-toolbar>
            <h2 class="card__title bottom-toolbar">KISMET Mobile Dashboard</h2>
        </ons-bottom-toolbar>
        <ons-fab id="button-pause" position="bottom left" modifier="mini" onclick="kmd.pauseResume()">
            <ons-icon icon="md-pause"></ons-icon>
        </ons-fab>
    </ons-page>
</template>

</body>
</html>
